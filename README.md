# Installation and Setup Guide for PostgreSQL and pgvector

## Step 1: Install PostgreSQL
Firstly, make sure to install PostgreSQL from the official website: [PostgreSQL Download](https://www.postgresql.org/download/).

## Step 2: Install pgvector Extension
Go to the pgvector GitHub repository at [pgvector GitHub](https://github.com/pgvector/pgvector) and follow the installation instructions. This will install the pgvector extension.

## Windows Installation Steps
Since I am using Windows, these were my steps:

1. Open a terminal and run the following command:
    ```
    call "C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\Build\vcvars64.bat"
    set "PGROOT=C:\Program Files\PostgreSQL\15"
    cd %TEMP%
    git clone --branch v0.8.0 https://github.com/pgvector/pgvector.git
    cd pgvector
    nmake /F Makefile.win
    nmake /F Makefile.win install
    ```

2. Log into PostgreSQL:
    ```
    psql -u postgres
    ```
   (Note: I am using `postgres` as my username; yours might be different. This will log us into the PostgreSQL database.)

3. Create a new database:
    ```
    CREATE DATABASE rag_db;
    ```

4. Connect to the new database:
    ```
    \c rag_db
    ```

5. Create the pgvector extension:
    ```
    CREATE EXTENSION IF NOT EXISTS vector;
    ```

6. Verify installation:
   If we get the below output, we can be sure that pgvector is installed.
   ```
   SELECT * FROM pg_available_extensions WHERE name = 'vector';
   ```
   ```
     name  | default_version | installed_version |                       comment
   --------+-----------------+-------------------+------------------------------------------------------
    vector | 0.8.0           | 0.8.0             | vector data type and ivfflat and hnsw access methods
   ```

7. Check for tables:
    ```
    \dt
    ```
   (Observe we have no tables here.)

---

## Step 3: Setting Up Your Project

Now download the .zip file from the drive and extract it.

Open a new terminal tab and run the following commands:

1. Create a new virtual environment:
    ```
    python -m venv env
    ```

2. Activate the virtual environment:
    ```
    .\env\Scripts\activate
    ```

3. Install the requirements:
    ```
    pip install -r requirements.txt
    ```

4. Make migrations:
    ```
    python manage.py makemigrations
    python manage.py migrate
    ```

5. Go back to the first terminal of psql and run:
   ```
   SELECT COUNT(*) FROM document_embeddings;
   ```
    We will get 0 records

---

## Step 4: Configuration

1. Go to `jktech_assignment > settings.py` and observe `DATABASES`. Here, you need to add your database credentials (For this i have given the credentials in the `.env` file, which i have attacted in the email. Please paste the `.env` file inthe root of this project).

2. Go to `rag_app > views.py` and observe `GEMINI_API_KEY`. (For this i have given the credentials in the `.env` file, which i have attacted in the email. Please paste the `.env` file inthe root of this project)

3. Observe the documents folder; this is where we need to add our documents.

4. Run the server:
    ```
    python manage.py runserver
    ```
   (Open http://127.0.0.1:8000 in your browser.)

---

## Step 5: Sample Queries

We can ask some below questions which will provide responses along with citations:

- What motivates Alice to follow the White Rabbit, and how does this action drive the story?
- How does Alice’s personality evolve throughout the story? Does she become more confident or curious?

- What are the key characteristics of Sherlock Holmes as depicted in the story?
- What unusual behavior does Mr. Windibank exhibit that raises suspicion about his character?

- How does the harsh environment of the Yukon affect the characters and their actions in the story?
- How does Jack London’s use of third-person narration influence our understanding of Buck’s thoughts and feelings?

---

## Step 6: Testing

1. Open a new terminal and run the following command:
    ```
    python manage.py test
    ```
All the test cases will run and pass.

2. Run the following command:
    ```
    coverage run manage.py test
    ```
This will run the tests and generate a coverage report.

3. Open the HTML file generated by the coverage command.
    ```
    start htmlcov/index.html
    ```

---

## Final Verification

Go back to the first terminal of psql and run:
```
SELECT COUNT(*) FROM document_embeddings;
```
(Observe we have one tables here, with 112 rows.)

```
SELECT * FROM document_embeddings;
```
Output will show all entries in document_embeddings table.
